name: ufc_analytics
description: UFC/MMA analytics semantic model for fight analysis and prediction

datasources:
  ufc_fights:
    type: table
    table: ufc_fights_all
    description: Complete UFC fight dataset with fighter statistics, odds, and match results from 1993 to present

dimensions:
  # Fight metadata dimensions
  weight_class:
    expression: ufc_fights.weight_class
    type: string
    label: Weight Class
    description: Weight division for the fight
    
  event_name:
    expression: ufc_fights.event_name
    type: string
    label: Event Name
    description: Name of the UFC event
    
  event_date:
    expression: ufc_fights.event_date
    type: date
    label: Event Date
    description: Date when the fight took place
    
  location:
    expression: ufc_fights.location
    type: string
    label: Location
    description: City and state/country where the fight occurred
    
  venue:
    expression: ufc_fights.venue
    type: string
    label: Venue
    description: Specific venue where the fight took place
    
  finish_method:
    expression: ufc_fights.method
    type: string
    label: Finish Method
    description: Method of victory (KO/TKO, SUB, Decision, etc.)
    
  is_title_fight:
    expression: ufc_fights.title_fight
    type: boolean
    label: Title Fight
    description: Whether this was a title fight
    
  gender:
    expression: ufc_fights.gender
    type: string
    label: Gender Division
    description: Gender division (Male/Female)
    
  # Fighter dimensions
  fighter1_name:
    expression: ufc_fights.fighter1
    type: string
    label: Fighter 1
    description: Name of the first fighter
    
  fighter2_name:
    expression: ufc_fights.fighter2
    type: string
    label: Fighter 2
    description: Name of the second fighter
    
  winner:
    expression: ufc_fights.winner
    type: string
    label: Winner
    description: Name of the winning fighter
    
  fighter1_stance:
    expression: ufc_fights.fighter1_stance
    type: string
    label: Fighter 1 Stance
    description: Fighting stance of fighter 1
    
  fighter2_stance:
    expression: ufc_fights.fighter2_stance
    type: string
    label: Fighter 2 Stance
    description: Fighting stance of fighter 2
    
  # Calculated dimensions
  event_year:
    expression: YEAR(ufc_fights.event_date)
    type: number
    label: Event Year
    description: Year when the fight took place
    
  fight_duration_category:
    expression: CASE 
      WHEN ufc_fights.round = 1 THEN "Round 1"
      WHEN ufc_fights.round = 2 THEN "Round 2"
      WHEN ufc_fights.round = 3 THEN "Round 3"
      WHEN ufc_fights.round >= 4 THEN "Championship Rounds"
      ELSE "Unknown"
    type: string
    label: Fight Duration Category
    description: Categorized fight duration
    
  finish_type:
    expression: CASE
      WHEN ufc_fights.method = "KO/TKO" THEN "Knockout"
      WHEN ufc_fights.method = "SUB" THEN "Submission"
      WHEN ufc_fights.method = "Decision" THEN "Decision"
      ELSE "Other"
    type: string
    label: Finish Type
    description: Simplified finish method categorization
    
  betting_outcome:
    expression: CASE
      WHEN ufc_fights.betting_outcome = "favorite" THEN "Favorite Won"
      WHEN ufc_fights.betting_outcome = "underdog" THEN "Underdog Won"
      ELSE "No Betting Data"
    type: string
    label: Betting Outcome
    description: Whether the favorite or underdog won

measures:
  # Basic fight counts
  total_fights:
    expression: COUNT(ufc_fights.fight_id)
    type: number
    label: Total Fights
    description: Total number of fights
    
  # Finish rates
  finish_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.method != "Decision") / COUNT(ufc_fights.fight_id) * 100
    type: number
    format: "%.1f%%"
    label: Finish Rate
    description: Percentage of fights that end before decision
    
  knockout_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.method = "KO/TKO") / COUNT(ufc_fights.fight_id) * 100
    type: number
    format: "%.1f%%"
    label: Knockout Rate
    description: Percentage of fights that end by KO/TKO
    
  submission_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.method = "SUB") / COUNT(ufc_fights.fight_id) * 100
    type: number
    format: "%.1f%%"
    label: Submission Rate
    description: Percentage of fights that end by submission
    
  # Title fight metrics
  title_fight_count:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.title_fight = true)
    type: number
    label: Title Fight Count
    description: Number of title fights
    
  title_fight_finish_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.title_fight = true AND ufc_fights.method != "Decision") / COUNT(ufc_fights.fight_id WHERE ufc_fights.title_fight = true) * 100
    type: number
    format: "%.1f%%"
    label: Title Fight Finish Rate
    description: Percentage of title fights that end before decision
    
  # Fighter performance averages
  avg_fighter1_age:
    expression: AVG(ufc_fights.fighter1_age)
    type: number
    format: "%.1f"
    label: Average Fighter 1 Age
    description: Average age of fighter 1 across all fights
    
  avg_fighter2_age:
    expression: AVG(ufc_fights.fighter2_age)
    type: number
    format: "%.1f"
    label: Average Fighter 2 Age
    description: Average age of fighter 2 across all fights
    
  avg_fighter1_reach:
    expression: AVG(ufc_fights.fighter1_reach)
    type: number
    format: "%.1f"
    label: Average Fighter 1 Reach
    description: Average reach of fighter 1 in inches
    
  avg_fighter2_reach:
    expression: AVG(ufc_fights.fighter2_reach)
    type: number
    format: "%.1f"
    label: Average Fighter 2 Reach
    description: Average reach of fighter 2 in inches
    
  # Win streak analysis
  avg_fighter1_win_streak:
    expression: AVG(ufc_fights.fighter1_win_streak)
    type: number
    format: "%.1f"
    label: Average Fighter 1 Win Streak
    description: Average win streak of fighter 1 going into fights
    
  avg_fighter2_win_streak:
    expression: AVG(ufc_fights.fighter2_win_streak)
    type: number
    format: "%.1f"
    label: Average Fighter 2 Win Streak
    description: Average win streak of fighter 2 going into fights
    
  # Betting metrics
  favorite_win_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.betting_outcome = "favorite") / COUNT(ufc_fights.fight_id WHERE ufc_fights.betting_outcome IS NOT NULL) * 100
    type: number
    format: "%.1f%%"
    label: Favorite Win Rate
    description: Percentage of fights where the betting favorite won
    
  underdog_win_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.betting_outcome = "underdog") / COUNT(ufc_fights.fight_id WHERE ufc_fights.betting_outcome IS NOT NULL) * 100
    type: number
    format: "%.1f%%"
    label: Underdog Win Rate
    description: Percentage of fights where the betting underdog won
    
  # Event metrics
  avg_event_attendance:
    expression: AVG(ufc_fights.attendance)
    type: number
    format: "%.0f"
    label: Average Event Attendance
    description: Average live attendance at events
    
  # Round analysis
  avg_fight_rounds:
    expression: AVG(ufc_fights.round)
    type: number
    format: "%.2f"
    label: Average Fight Rounds
    description: Average number of rounds fights last
    
  round_1_finish_rate:
    expression: COUNT(ufc_fights.fight_id WHERE ufc_fights.round = 1) / COUNT(ufc_fights.fight_id) * 100
    type: number
    format: "%.1f%%"
    label: Round 1 Finish Rate
    description: Percentage of fights that end in round 1
    
  # Strike statistics
  avg_fighter1_sig_strikes_pm:
    expression: AVG(ufc_fights.fighter1_sig_strikes_pm)
    type: number
    format: "%.2f"
    label: Average Fighter 1 Significant Strikes Per Minute
    description: Average significant strikes landed per minute by fighter 1
    
  avg_fighter2_sig_strikes_pm:
    expression: AVG(ufc_fights.fighter2_sig_strikes_pm)
    type: number
    format: "%.2f"
    label: Average Fighter 2 Significant Strikes Per Minute
    description: Average significant strikes landed per minute by fighter 2